version: '2.2'

services:
  os:
    build:
      context: .
      dockerfile: Dockerfile.template
      args:
        OS_VERSION: ${OS_VERSION:-2.95.12_rev1}
        DEVICE_TYPE: ${DEVICE_TYPE:-genericx86-64-ext}
    privileged: true
    stop_signal: SIGRTMIN+3
    stop_grace_period: 30s
    volumes:
      - /lib/modules:/lib/modules:ro
      - ${CONFIG_JSON:-./config.json}:/var/local/config.json
    tmpfs:
      - /run
      - /tmp
      - /var/lib/journal
      - /sys/fs/cgroup
      - /mnt/boot
      - /mnt/data
      - /mnt/state
    tty: true